<style>
  .collection_popular_list {
    padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
    padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
    background-color: rgb(var(--color-background));
    display: block;
    position: relative;
  }

  @media (max-width: 767px) {
    .collection_popular_list {
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
    }
  }

  .featured-product-row-one {
    max-width: 100%;
    width: 100%;
  }

  .popular-product-collections {
    display: block;
    position: relative;
    margin: 15px 0;
  }

  .popular-product-main-block {
    display: flex;
    max-width: 100%;
    width: 100%;
    justify-content: center;
    align-items: center;
    flex-wrap: wrap;
    padding: 0;
    list-style-type: none;
    margin: 0;
  }

  ul.popular-main-product-block {
    margin: 0;
    padding: 0;
  }

  li.popular-product-collection-main {
    padding: 0 20px;
    text-transform: uppercase;
    position: relative;
  }

  li.popular-product-collection-main a.popular-product-collection-name {
    position: relative;
    color: rgb(var(--color-foreground), 0.8);
    font-weight: 500;
    transition: all 0.4s ease-in-out;
  }

  li.popular-product-collection-main a.popular-product-collection-name::after {
    content: '';
    display: block;
    position: absolute;
    top: 100%;
    max-width: 0;
    width: 100%;
    left: 0;
    height: 1px;
    transition: max-width 0.28s cubic-bezier(0.47, 0, 0.745, 0.715);
    background-color: rgb(var(--color-foreground));
  }

  li.popular-product-collection-main a.popular-product-collection-name:hover {
    color: rgb(var(--color-foreground));
  }

  li.popular-product-collection-main a.popular-product-collection-name:hover::after {
    width: 100%;
    max-width: 100%;
  }

  li.popular-product-collection-main.active a.popular-product-collection-name {
    color: rgb(var(--color-foreground));
  }

  li.popular-product-collection-main.active a.popular-product-collection-name::after {
    content: '';
    display: block;
    position: absolute;
    top: 100%;
    max-width: 100%;
    width: 100%;
    left: 0;
    height: 1px;
    background-color: rgb(var(--color-foreground));
  }

  div.popular-block {
    padding-top: 20px;
  }

  .popular-product-inner {
    display: none;
  }

  .popular-product-inner.active {
    display: flex;
  }

  .popular-product-inner-block {
    max-width: 100%;
    padding: 7.5px;
    width: 100%;
    display: block;
  }

  @media (max-width: 991px) {}

  @media (max-width: 551px) {
    li.popular-product-collection-main {
      padding: 0 10px 5px;
    }
  }

  @media (max-width: 480px) {}
</style>

<div
  class="collection_popular_list color-{{ section.settings.color_scheme }} gradient section-{{ section.id }}-padding">
  <section class="main-content">
    <div class="main-container featured-product-main">
      {% if section.settings.heading != blank or section.settings.content-inner != blank %}
      <div class="main_section_head">
        {% if section.settings.heading != blank %}
        <h2 class="heading">{{ section.settings.heading }}</h2>
        {% endif %}
        {% if section.settings.content-inner != blank %}
        {{ section.settings.content-inner }}
        {% endif %}
      </div>
      {% endif %}

      <div class="popular-product">
        <ul class="popular-product-main-block">
          {% for block in section.blocks %}
          <li class="popular-product-collection-main">
            {% if block.settings.collection_id != blank %}
            <a class="popular-product-collection-name" href="#coll{{ forloop.index }}">
              {{ block.settings.collection_id }}
            </a>
            {% else %}
            <a class="popular-product-collection-name" href="#coll{{ forloop.index }}">Collection</a>
            {% endif %}
          </li>
          {% endfor %}
        </ul>

        <div class="popular-block">
          {% for block in section.blocks %}
          <div class="popular-product-inner" id="coll{{ forloop.index }}" {% if forloop.first %} style="display: flex;"
            {% else %} style="display:none" {% endif %}>
            <div class="featured-product-row-one">
              {% if block.settings.collection_id != blank %}
              {%- assign collection = block.settings.collection_id -%}
              {% for product in collections[collection].products limit: 4 %}
              <div class="popular-product-inner-block featured_product">
                {% render 'card-product'
                , product: product
                , collection: collection %}
              </div>
              {% endfor %}
              {% comment %} <a href="/pages/compare" class="compare-link">
                Compare Products ({{ 'compareList' | localStorageCount }})
              </a> {% endcomment %}
              {% else %}
              <div class="featured-product-row placeholder">
                <div class="featured-product-url placeholder">
                  <div class="featured-product-img">
                    {{ 'product-1' | placeholder_svg_tag }}
                  </div>
                  <div class="main-product-content">
                    <div class="featured-product-title">
                      <h3 class="title">Example of Product</h3>
                    </div>
                  </div>
                </div>

                <div class="featured-product-url placeholder">
                  <div class="featured-product-img">
                    {{ 'product-2' | placeholder_svg_tag }}
                  </div>
                  <div class="main-product-content">
                    <div class="featured-product-title">
                      <h3 class="title">Example of Product</h3>
                    </div>
                  </div>
                </div>

                <div class="featured-product-url placeholder">
                  <div class="featured-product-img">
                    {{ 'product-3' | placeholder_svg_tag }}
                  </div>
                  <div class="main-product-content">
                    <div class="featured-product-title">
                      <h3 class="title">Example of Product</h3>
                    </div>
                  </div>
                </div>

                <div class="featured-product-url placeholder">
                  <div class="featured-product-img">
                    {{ 'product-4' | placeholder_svg_tag }}
                  </div>
                  <div class="main-product-content">
                    <div class="featured-product-title">
                      <h3 class="title">Example of Product</h3>
                    </div>
                  </div>
                </div>
              </div>
              {% endif %}
            </div>
          </div>
          {% endfor %}
        </div>
      </div>
    </div>
  </section>
</div>

<script>
  function popularList() {
    $(document).ready(function () {
      $('.popular-product-collection-main:first-child').addClass('active');

      $('.popular-product .popular-product-main-block a').on('click', function (e) {
        e.preventDefault();

        var currentAttrValue = $(this).attr('href');
        $('.popular-product-inner').hide();
        $('.popular-product ' + currentAttrValue).fadeIn(400);

        $(this).parent('li.popular-product-collection-main').addClass('active').siblings().removeClass('active');

        // First unslick (if already slick)
        if ($('.featured-product-row-one').hasClass('slick-initialized')) {
          $('.featured-product-row-one').slick('unslick');
        }

        // Delay to ensure DOM update before re-initializing
        setTimeout(function () {
          initializeSlick();
          quickView(); // Call after slick is re-initialized
        }, 100);
      });

      initializeSlick();
      quickView(); // Call initially too
    });
  }

  function initializeSlick() {
    $('.featured-product-row-one').slick({
      slidesToShow: 4,
      slidesToScroll: 1,
      autoplay: false,
      autoplaySpeed: 3000,
      arrows: true,
      dots: false,
      responsive: [
        {
          breakpoint: 991,
          settings: {
            slidesToShow: 3
          }
        },
        {
          breakpoint: 768,
          settings: {
            slidesToShow: 2
          }
        },
        {
          breakpoint: 480,
          settings: {
            slidesToShow: 1
          }
        }
      ]
    });
  }

  popularList();
</script>




{% schema %}
{
"name": "Collection List Product",
"settings": [
{
"type": "color_scheme",
"id": "color_scheme",
"label": "Color Scheme",
"default": "scheme-1"
},
{
"type": "range",
"id": "padding_top",
"min": 0,
"max": 100,
"step": 4,
"unit": "px",
"label": "Padding Top",
"default": 36
},
{
"type": "range",
"id": "padding_bottom",
"min": 0,
"max": 100,
"step": 4,
"unit": "px",
"label": "Padding Bottom",
"default": 36
},
{
"type": "text",
"id": "heading",
"label": "Title",
"default": "Heading"
}, {
"type": "text",
"id": "content-inner",
"label": "Description",
"default": "Content"
}, {
"type": "checkbox",
"id": "second_img",
"label": "Enable to on hover Second Image"
},
{
"type": "checkbox",
"id": "compare_product",
"label": "Compare Prouct"
}
],
"blocks": [
{
"type": "collection",
"name": "Collection",
"limit": 5,
"settings": [
{
"type": "collection",
"id": "collection_id",
"label": "Collection"
}
]
}
],
"presets": [
{
"name": "Collection List Product",
"blocks": [
{
"type": "collection"
}, {
"type": "collection"
}, {
"type": "collection"
}, {
"type": "collection"
}
]
}
]
}
{% endschema %}